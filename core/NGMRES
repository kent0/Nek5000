      common /ngmres/  x_gmres(lx1*ly1*lz1*lelv)
     $               , r_gmres(lx1*ly1*lz1*lelv)
     $               , w_gmres(lx1*ly1*lz1*lelv)
     $               , h_gmres(lgmres,lgmres), gamma_gmres(lgmres+1)
     $               , c_gmres(lgmres), s_gmres(lgmres)

      common /ngmre1/  v_gmres(lx1*ly1*lz1*lelv,lgmres)
      common /ngmre2/  z_gmres(lx1*ly1*lz1*lelv,lgmres)

      common /nspltprec/ ml_gmres(lx1*ly1*lz1*lelv),
     $                   mu_gmres(lx1*ly1*lz1*lelv)
      real ml_gmres,mu_gmres
      
c     w is a work vector
c     c and s store the Givens rotations
c     V stores the orthogonal Krylov subspace basis
c          -1
c     Z = M   V
